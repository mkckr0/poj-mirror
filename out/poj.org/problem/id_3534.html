<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3534 -- Escape of Life and Death</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3534"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3534&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Escape of Life and Death</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 5000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 131072K</td></tr><tr><td><b>Total Submissions:</b> 2599</td><td width="10px"></td><td><b>Accepted:</b> 326</td></tr><tr><td align="center" colspan="3" style="color:#0ead00"><b>Case Time Limit:</b> 2000MS</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>During his ambitious adventure in search of treasure, Yangyang discovered an ancient underground palace. After thoroughly exploring the palace, he found that it was constructed with elaborately decorated chambers connected by fortified corridors. Out of an explorer’s instinct, he sketched a complete map of the palace before entering the largest and most magnificent chamber, which lied in the heart of the palace.</p><p>Standing at the center of the chamber, Yangyang looked around and was profoundly amazed by those vivid, huge statues of the gods. He recognized the tallest one, which depicted God Proxima holding his sacred cane. All of a sudden, a voice took Yangyang by surprise, “Leave now, you stupid human!” It was loud but sounded as if it came from the distance. A thought of danger immediately flashed through Yangyang’s mind: his intrusion into the palace had triggered a spell of destruction. Now an earthquake was emerging from right under the chamber and growing more and more violent. He must escape from underground for life as quickly as possible.</p><p>Yangyang knew that seismic waves propagated isotropically at a constant speed. If they spread across any chamber, the chamber would collapse, trap anybody inside and become impassable. However, the corridors were adequately solid to stand any impact of earthquake. Driven by his fearless but obstinate character, Yangyang would only allow himself to run from one chamber to another one which was farther away from the epicenter except when he was going to run toward chamber <i>n</i> + 1.</p><p>Yangyang had measured the location of each chamber and estimated the time he needed to run through each corridor. How soon could he accomplish the escape of life and death?</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input consists of a single test case. The first line of input contains three integers <i>n</i>, <i>m</i>, <i>v</i> (1 ≤ <i>n</i> ≤ 50,000, 1 ≤ <i>m</i> ≤ 200,000, 1 ≤ <i>v</i> ≤ 1,000). Next come <i>n</i> lines, each containing a pair of integers (<i>x<sub>i</sub></i>, <i>y<sub>i</sub></i>) (−10<sup>9</sup> ≤ <i>x<sub>i</sub></i>, <i>y<sub>i</sub></i> ≤ 10<sup>9</sup>, ∀1 ≤ <i>i</i> ≤ <i>n</i>). The following <i>m</i> lines each contains three integers <i>a<sub>i</sub></i>, <i>b<sub>i</sub></i>, <i>t<sub>i</sub></i> (0 ≤ <i>a<sub>i</sub></i>, <i>b<sub>i</sub></i> ≤ <i>n</i> + 1, 1 ≤ <i>t<sub>i</sub></i> ≤ 1,000, ∀1 ≤ <i>i</i> ≤ <i>m</i>). The last line contains two pairs of integers (<i>x</i><sub>0</sub>, <i>y</i><sub>0</sub>), (<i>x</i><sub><i>n</i>+1</sub>, <i>y</i><sub><i>n</i>+1</sub>) (−10<sup>9</sup> ≤ <i>x</i><sub>0</sub>, <i>y</i><sub>0</sub>, <i>x</i><sub><i>n</i>+1</sub>, <i>y</i><sub><i>n</i>+1</sub> ≤ 10<sup>9</sup>).</p><p>There were <i>n</i> + 2 chambers in total, numbered 0 through <i>n</i> + 1. Chamber 0 was where Yangyang found the statue of God Proxima; chamber <i>n</i> + 1 was located, as the only exception, on the ground and would not trap Yangyang even if it collapsed. Chamber <i>i</i> (1 ≤ <i>i</i> ≤ <i>n</i>) was located at (<i>x<sub>i</sub></i>, <i>y<sub>i</sub></i>). Corridor <i>i</i> (1 ≤ <i>i</i> ≤ <i>m</i>) connected chambers <i>a<sub>i</sub></i> and <i>b<sub>i</sub></i>, and Yangyang needed <i>t<sub>i</sub></i> units of time to run through it. Seismic waves propagated at constant speed <i>v</i>.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>If Yangyang could escape, output the minimum time he needed; otherwise, output “<tt>Impossible</tt>”.</p></div><p class="pst">Sample Input</p><pre class="sio">1 2 1
3 4
0 1 5
1 2 5
0 0 6 8</pre><p class="pst">Sample Output</p><pre class="sio">Impossible</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>As can be inferred from the sample test case, if seismic waves reached a chamber at the very moment Yangyang began to escape from it, he would still get trapped.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=POJ+Founder+Monthly+Contest+%E2%80%93+2008.03.16">POJ Founder Monthly Contest – 2008.03.16</a>, Gao Yihan</div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3534">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3534">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3534">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
