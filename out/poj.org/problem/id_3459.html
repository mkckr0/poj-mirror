<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3459 -- Projects</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3459"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3459&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Projects</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 1006</td><td width="10px"></td><td><b>Accepted:</b> 437</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In a certain week, a company wants to finish <i>m</i> projects. To this end, the company can employ at most <i>n</i> people from the unemployment agency for a period of one week. Each external employee will cost the company <tt>salary</tt> euro, unless the project in which he/she is involved is not completed in time. In that case no payment is due.</p><p>For each project the company knows from experience the probability that the project will be completed within a week, as a function of the number of employees working on it. These probabilities are given as percentages <i>p<sub>ij</sub></i>, where <i>i</i> (with 1 ≤ <i>i</i> ≤ <i>m</i>) is the number of the project and <i>j</i> is the number of people working on it. Of course, when nobody is working on a project <i>i</i>, the probability <i>p<sub>i</sub></i><sub>0</sub> is zero percent.</p><p>If project <i>i</i> is indeed finished within a week, the company earns <tt>reward</tt>(<i>i</i>) euro; if it is not ready in time, the company has to pay a fine of <tt>punishment</tt>(<i>i</i>) euro.</p><p>Of course the company wants to maximise its total expected profit<sup>1</sup> at the end of the week by finding the optimal number of external employees to hire, and how to divide them over the projects. The optimal number of employees is the total number of people needed to achieve the maximal expected profit. Your task in this matter is to calculate this optimal number of external employees. Remember that at most <i>n</i> people are available. Furthermore: if a person is employed, he/she works on one and only one project.</p><hr align="left" color="#000000" noshade="" size="1" width="30%"/><p><small><sup>1</sup>Let <i>p</i> (0 &lt; <i>p</i> &lt; 1) be the probability that a job is finished in time, and let <i>E</i><sub>1</sub> be the profit in that case. Furthermore, let <i>E</i><sub>2</sub> be the (negative) profit in case the job is not finished in time. Then the expected profit for this particular job is <i>p</i>⋅<i>E</i><sub>1</sub> + (1 − <i>p</i>)⋅<i>E</i><sub>2</sub>.</small></p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains a single number: the number of test cases to follow. Each test case has the following format:</p><ul><li>One line with one integer <i>m</i> with 1 ≤ <i>m</i> ≤ 100: the number of projects.</li><li>One line with one integer <i>n</i> with 0 ≤ <i>n</i> ≤ 100: the maximal number of available employees.</li><li>One line with one integer salary with 0 ≤ <tt>salary</tt> ≤ 1,000: the salary of one employee. Remember that the salary is given in euros.</li><li><i>m</i> lines, each line corresponding to a project <i>i</i>, containing <i>n</i> integers <i>p<sub>i</sub></i><sub>1</sub>, <i>p<sub>i</sub></i><sub>2</sub>, …, <i>p<sub>in</sub></i> (the percentages, with 0 ≤ <i>p<sub>i</sub></i><sub>1</sub>, <i>p<sub>i</sub></i><sub>2</sub>, …, <i>p<sub>in</sub></i> ≤ 100), followed by two integers corresponding to the <tt>reward</tt> and the <tt>punishment</tt> for project <i>i</i>. All values are separated by single spaces. Both <tt>reward</tt> and <tt>punishment</tt> are given in euros and are between 0 and 100,000 (boundaries included).</li></ul></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For every test case in the input file, the output should contain two lines.</p><ul><li>The first line contains the maximal expected profit in eurocents.</li><li>The second line contains the total number of external employees that must be hired in order to achieve this maximal expected profit. If the maximal expected profit can be achieved by different (total) numbers of employees, then these different numbers must be given in increasing order. Numbers have to be separated by single spaces.</li></ul></div><p class="pst">Sample Input</p><pre class="sio">3
1
4
200
90 100 100 100 2000 0
2
2
100
80 80 2100 500
0 100 1700 500
3
4
100
100 80 80 70 1000 100
100 90 80 90 500 50
100 70 60 50 700 100</pre><p class="pst">Sample Output</p><pre class="sio">162000
1
100000
1 2
190000
3</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=BAPC+2006+Qualification">BAPC 2006 Qualification</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3459">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3459">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3459">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
