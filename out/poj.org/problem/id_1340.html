<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>1340 -- The Longest Detour Problem</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D1340"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=1340&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">The Longest Detour Problem</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 10000K</td></tr><tr><td><b>Total Submissions:</b> 695</td><td width="10px"></td><td><b>Accepted:</b> 231</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">Let G be a weighted graph, i.e., every edge in G is associated with a nonnegative integer weight. The length of a path is the sum of edge weights in the path. A shortest path between vertices r and s in G, denoted by P<sub>G</sub>(r, s), is defined as a path with the shortest length from r to s. The distance between vertices r and s, denoted by d<sub>G</sub>(r, s), is the length of the shortest path P<sub>G</sub>(r, s). For two vertices in a connected graph, there exists at least one shortest path between them. Let e = (u, v) be an edge in P<sub>G</sub>(r, s) with v closer to s than u (v may be s). Let G - e denote the subgraph obtained by removing edge e from G. A detour from u is the shortest path from u to s in G - e, or P<sub>G-e</sub>(u, s). Edge e is a detour -critical edge in P<sub>G</sub>(r, s) if the removal of e results in the maximum distance increment from u to s. In other words, if e is a detour -critical edge in P<sub>G</sub>(r, s), then d<sub>G-e</sub>(u, s) - d<sub>G</sub>(u, s) is maximum among all edges in P<sub>G</sub>(r, s). The longest detour problem is to find the maximum distance increment of a shortest path.<br/> <br/> <br/><center><img src="../images/1340_1.jpg"/> <br/>Figure 4: A weighted graph G.</center> <br/> <br/>For example, see Figure 4. P<sub>G</sub>(4, 1) =&lt; 4, 3, 2, 1 &gt; is the shortest path from vertex 4 to vertex 1. Path &lt; 4, 6, 1 &gt; is the detour from vertex 4 to vertex 1 if edge (4, 3) is removed. Path &lt; 3, 5, 1 &gt; is the detour from vertex 3 to vertex 1 if edge (3, 2) is removed. Path &lt; 2, 5, 1 &gt; is the detour from vertex 2 to vertex 1 if edge (2, 1) is removed. The detour -critical edge in P<sub>G</sub>(4, 1) is not edge (4, 3) or edge (2, 1) but edge (3, 2) since d<sub>G-(3,2)</sub>(3, 1) - d<sub>G</sub>(3, 1) = 600 - 200 = 400 is greater than d<sub>G-(4,3)</sub>(4, 1) - d<sub>G</sub>(4, 1) = 500 - 300 = 200 and d<sub>G-(2,1)</sub>(2, 1) - d<sub>G</sub>(2, 1) = 200 - 100 = 100.<br/> <br/>The algorithm for finding detours, as well as determining the detour-critical edges, is important from the viewpoint of network management. Due to a sudden edge failure<br/> <br/>from some vertex, the message must be retransmitted through a detour from the vertex adjacent to the faulty edge.<br/> <br/>Suppose that we have several networks. Each network is connected and contains at most n vertices, where 3 &lt;= n &lt;= 100. Assume now that you are hired to serve as a<br/> <br/>network administrator and have to determine the maximum distance increment caused by a detour-critical edge of a given shortest path for each network.<br/></div><p class="pst">Input</p><div class="ptx" lang="en-US">The input consists of several test cases. The first line contains an integer indicating the number of test cases. Each test case starts with a positive integer n, where 3 &lt;= n &lt;= 100. The following n lines represent the adjacency matrix of a network. An adjacency matrix of a network G with n vertices, denoted by A(G) = [w<sub>u,v</sub>], is an n * n matrix such that w<sub>u,v</sub> &gt; 0 if (u, v) is an edge of G, and w<sub>u,v</sub>= 0 otherwise, where w<sub>u,v</sub> in a nonnegative integer. Note that any two elements in each line of an adjacency matrix are separated by a space. The last line of each test case represents the sequence of vertices in a given shortest path in which there is also a space between two vertices. Note that the first and the last vertices denote the source and the destination vertices, respectively. For example, the adjacency matrix of the graph in Figure 4 is shown in test case 3 of the sample input.</div><p class="pst">Output</p><div class="ptx" lang="en-US">For each test case, output the maximum distance increment caused by the detour-critical edge of the given shortest path in one line.</div><p class="pst">Sample Input</p><pre class="sio">3
3
0 10 20
10 0 10
20 10 0
3 2 1
4
0 10 10 30
10 0 30 0
10 30 0 10
30 0 10 0
4 3 1 2
6
0 100 0 0 100 200
100 0 100 0 100 400
0 100 0 100 500 0
0 0 100 0 500 300
100 100 500 500 0 0
200 400 0 300 0 0
4 3 2 1</pre><p class="pst">Sample Output</p><pre class="sio">20
30
400</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Taiwan+2002">Taiwan 2002</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=1340">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=1340">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=1340">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
