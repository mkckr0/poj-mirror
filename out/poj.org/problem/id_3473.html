<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3473 -- Stochastic Finite State Automaton</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3473"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3473&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Stochastic Finite State Automaton</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 4000MS</td><td width="10px"></td><td colspan="3"><b>Memory Limit:</b> 131072K</td></tr><tr><td><b>Total Submissions:</b> 115</td><td width="10px"></td><td><b>Accepted:</b> 26</td><td width="10px"></td><td style="font-weight:bold; color:red;">Special Judge</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>The finite state automaton (FSA) is an important model of behavioral investigations in computer science, linguistics as well as many other different areas of study. In theoretical computer science literature, an FSA is typically modeled as a string pattern recognizer described with a quintuple &lt;Σ, <i>S</i>, <i>s</i><sub>0</sub>, <i>δ</i>, <i>F</i>&gt;, where: </p><ul><li>Σ is the input alphabet (a finite nonempty set of symbols). </li><li><i>S</i> is a finite nonempty set of states. </li><li><i>s</i><sub>0</sub> is an element in <i>S</i> designated as the initial state. </li><li><i>δ</i> is a function <i>δ</i> : <i>S</i> × Σ → <i>S</i> known as the transition function. </li><li><i>F</i> is a (possibly empty) subset of <i>S</i> whose elements are designated as the final states. </li></ul><p>An FSA with the above description operates as follows: </p><ul><li>At the beginning, the automaton starts in the initial state <i>s</i><sub>0</sub>. </li><li>The automaton continuously reads symbols from its input, one symbol at a time, and transits between states according to the transition function <i>δ</i>. To be specific, let <i>s</i> be the current state and <i>w</i> the symbol just read, the automaton transits to the state given by <i>δ</i>(<i>s</i>, <i>w</i>). </li><li>When the automaton reaches the end of the input, if the current state belongs to <i>F</i>, the string consisting sequentially of the symbols read by the automaton is declared accepted, otherwise it is declared rejected. </li></ul><p>We will not delve into further details concerning the FSA but focus on a slightly simplified variant – the stochastic finite state automaton (SFSA). An SFSA is described with a duple &lt;<b><i>A</i></b>, <b><i>b</i></b>&gt;, where:</p><ul><li><b><i>A</i></b> is an <i>n</i>-by-<i>n</i> nonnegative square matrix.</li><li><b><i>b</i></b> is an <i>n</i>-dimensional nonnegative column vector.</li></ul><p>The automaton assumes the first <i>n</i> positive integers as its states. Unlike a normal FSA, it does not read any symbols and consequently does not have an input alphabet. And its transitions are completely self-determined. Concretely speaking, an SFSA operates as follows:</p><ul><li>At the beginning, the automaton selects randomly a positive integer not exceeding <i>n</i>, <i>i</i>, as the initial state with probability <i>b</i><sub><i>i</i></sub>, the <i>i</i>-th component of <b><i>b</i></b>. (It is required that the components of <b><i>b</i></b> sum to exactly 1.)</li><li>At any stage before the automation halts, let <i>j</i> be the current state, the automaton selects randomly a positive integer not exceeding <i>n</i>, <i>i</i>, with probability <i>a</i><sub><i>ij</i></sub>, the element of <b><i>A</i></b> located in the <i>i</i>-th row and the <i>j</i>-th column, or 0 with probability <img align="absmiddle" src="../formula?tex=%5Ctextstyle+1-%5Csum_%7Bi%3D1%7D%5Ena_%7Bij%7D&amp;driver=1"/>. If the automaton selects 0, it halts immediately, otherwise it transits to state <i>i</i>. (It is required that the sum of elements of every column of <b><i>A</i></b> be not less than or equal to 1.)</li></ul><p>Deriving from the above description, we can draw several implications concerning the SFSA. For instance, observably, the automaton may make an infinite number of transits and never halt, but intuitively, this is very unlikely to occur. Before scrutinizing the behavioral features of the SFSA, it is advisable to first investigate its statistical characteristics, namely, we want to know for each state <i>i</i>, the probability that the automaton decides to halt in that state and, given that automaton halts in that state, the expectation as well as the standard deviation of the number of transitions that have been made.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input consists of a single test case. The first input line contains the number <i>n</i> (1 ≤ <i>n</i> ≤ 200) alone. The next <i>n</i> lines each contain <i>n</i> nonnegative numbers, giving the elements of an <i>n</i>-by-<i>n</i> square matrix <b><i>A</i></b> in row-major order. On the last line, there are <i>n</i> nonnegative numbers which are the components of an <i>n</i>-dimensional column vector <b><i>b</i></b> in increasing order of their indices. The sum of elements in every column of <b><i>A</i></b> is <i>strictly less than</i> 1, and the components of <b><i>b</i></b> sum to exactly 1. The duple &lt;<b><i>A</i></b>, <b><i>b</i></b>&gt; constitutes the description of an SFSA.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each state in increasing order of their numerical values, output in order and as accurate as possibly the probability that the automaton decides to halt in that state and, given that automaton halts in that state, the expectation as well as the standard deviation of the number of transitions that have been made. A special checker program that admits an relative error of 10<sup>−6</sup> is used to verify the output.</p></div><p class="pst">Sample Input</p><pre class="sio">3
0.25 0 0
0.25 0 0
0.25 0 0
1 0 0</pre><p class="pst">Sample Output</p><pre class="sio">0.33333333 0.33333333 0.66666667
0.33333333 1.33333333 0.66666667
0.33333333 1.33333333 0.66666667</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>For a random variable <i>X</i>, Var(<i>X</i>) = E(<i>X</i><sup>2</sup>) − (E(<i>X</i>))<sup>2</sup>.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=POJ+Founder+Monthly+Contest+%E2%80%93+2007.12.30">POJ Founder Monthly Contest – 2007.12.30</a>, frkstyc</div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3473">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3473">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3473">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
