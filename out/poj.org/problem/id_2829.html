<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>2829 -- How Many Free Dimensions?</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D2829"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=2829&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">How Many Free Dimensions?</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 164</td><td width="10px"></td><td><b>Accepted:</b> 41</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In calculating the outer product of vectors, existence of constraints usually makes it that not all the components of the product are independent of the others. For example, the outer product of two two-dimensional vectors <b><i>A</i></b> = (<i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>) and <b><i>B</i></b> = (<i>b</i><sub>1</sub>, <i>b</i><sub>2</sub>), <b><i>C</i></b> = <b><i>A</i></b> × <b><i>B</i></b> = (<i>c</i><sub>11</sub>, <i>c</i><sub>12</sub>, <i>c</i><sub>21</sub>, <i>c</i><sub>22</sub>). If we set <i>c</i><sub>12</sub> = <i>c</i><sub>21</sub>, then only three of the four components of <b><i>C</i></b> is independent, or <b><i>C</i></b> has three free dimensions.</p><p>Now we have <i>k</i> <i>n</i>-dimensional vectors <b><i>A</i></b><sub>1</sub>, <b><i>A</i></b><sub>2</sub>, …, <i><b>A</b><sub>k</sub></i>. The product of them is a vector of <i>n<sup>k</sup></i> components <b><i>Z</i></b> = (<i>z<sub>α</sub></i>) where <i>α</i> enumerates all possible subscripts <i>i</i><sub>1</sub><i>i</i><sub>2</sub>…<i>i<sub>k</sub></i> (1 ≤ <i>i<sub>j</sub></i> ≤ <i>n</i> for all <i>j</i> s.t. 1 ≤ <i>j</i> ≤ <i>k</i>). We can then apply a rule of constraint of the form <i>s</i><sub>1</sub><i>s</i><sub>2</sub>…<i>s<sub>k</sub></i>=<i>t</i><sub>1</sub><i>t</i><sub>2</sub>…<i>t<sub>k</sub></i> to the subscripts. Here <i>s</i><sub>1</sub><i>s</i><sub>2</sub>…<i>s<sub>k</sub></i> and <i>t</i><sub>1</sub><i>t</i><sub>2</sub>…<i>t<sub>k</sub></i> are two strings consisting of the same set of lowercase letters. A letter appearing in one string will also appear in the other one and it can have multiple occurrences in a string. When a rule is applied, the letters in it are replaced by arbitrary integers between 1 and <i>n</i> (inclusive) provided that the same letters are replaced by the same integers and different letters are replaced by different integers. If a resulted string after replacements is <i>p</i><sub>1</sub><i>p</i><sub>2</sub>…<i>p<sub>k</sub></i>=<i>q</i><sub>1</sub><i>q</i><sub>2</sub>…<i>q<sub>k</sub></i>, let <i>α</i> be <i>p</i><sub>1</sub><i>p</i><sub>2</sub>…<i>p<sub>k</sub></i> and <i>β</i> be <i>q</i><sub>1</sub><i>q</i><sub>2</sub>…<i>q<sub>k</sub></i>, then we set <i>z<sub>α</sub></i> = <i>z<sub>β</sub></i>. Given the number of vectors and their dimensions and a rule of constraint, you are required to compute the number of free dimensions of the product of the vectors.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains several test cases. Each test case consists of two lines followed by a blank one. On the first line there are two integers which are <i>n</i> and <i>k</i> in the order they appear. On the second line is a rule of constraint. Two zeroes on a separate line follow the last test case.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each test case, output one line containing the number of free dimensions of the product of vectors.</p></div><p class="pst">Sample Input</p><pre class="sio">2 2
ij=ji

3 3
iij=jii

0 0</pre><p class="pst">Sample Output</p><pre class="sio">3
21</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>In the second test case in the sample input, the rule <i>iij</i>=<i>jii</i> represents the constraints <i>z</i><sub>112</sub> = <i>z</i><sub>211</sub>, <i>z</i><sub>113</sub> = <i>z</i><sub>311</sub>, <i>z</i><sub>221</sub> = <i>z</i><sub>122</sub>, <i>z</i><sub>223</sub> = <i>z</i><sub>322</sub>, <i>z</i><sub>331</sub> = <i>z</i><sub>133</sub> and <i>z</i><sub>332</sub> = <i>z</i><sub>233</sub>.</p><p>You can safely assume that all calculations can be done with 64-bit integers.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=POJ+Monthly--2006.05.28">POJ Monthly--2006.05.28</a>, Liang, Shaochi</div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=2829">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=2829">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=2829">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
