<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3010 -- The Genome Database of All Space Life</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3010"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3010&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">The Genome Database of All Space Life</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 875</td><td width="10px"></td><td><b>Accepted:</b> 258</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>In 2300, the Life Science Division of Federal Republic of Space starts a very ambitious project to complete the genome sequencing of all living creatures in the entire universe and develop the genomic database of all space life. Thanks to scientific research over many years, it has been known that the genome of any species consists of at most 26 kinds of molecules, denoted by English capital letters (<i>i.e.</i> <tt>A</tt> to <tt>Z</tt>).</p><p>What will be stored into the database are plain strings consisting of English capital letters. In general, however, the genome sequences of space life include frequent repetitions and can be awfully long. So, for efficient utilization of storage, we compress <i>N</i>-times repetitions of a letter sequence <i>seq</i> into <i>N</i><tt>(</tt><i>seq</i><tt>)</tt>, where <i>N</i> is a natural number greater than or equal to two and the length of <i>seq</i> is at least one. When <i>seq</i> consists of just one letter <i>c</i>, we may omit parentheses and write <i>Nc</i>.</p><p>For example, a fragment of a genome sequence:</p><blockquote><p><tt>ABABABABXYXYXYABABABABXYXYXYCCCCCCCCCC</tt></p></blockquote><p>can be compressed into:</p><blockquote><p><tt>4(AB)XYXYXYABABABABXYXYXYCCCCCCCCCC</tt></p></blockquote><p>by replacing the first occurrence of <tt>ABABABAB</tt> with its compressed form. Similarly, by replacing the following repetitions of <tt>XY</tt>, <tt>AB</tt>, and <tt>C</tt>, we get:</p><blockquote><p><tt>4(AB)3(XY)4(AB)3(XY)10C</tt></p></blockquote><p>Since <tt>C</tt> is a single letter, parentheses are omitted in this compressed representation. Finally, we have:</p><blockquote><p><tt>2(4(AB)3(XY))10C</tt></p></blockquote><p>by compressing the repetitions of <tt>4(AB)3(XY)</tt>. As you may notice from this example, parentheses can be nested.</p><p>Your mission is to write a program that uncompress compressed genome sequences.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input consists of multiple lines, each of which contains a character string <i>s</i> and an integer <i>i</i> separated by a single space.</p><p>The character string <i>s</i>, in the aforementioned manner, represents a genome sequence. You may assume that the length of <i>s</i> is between 1 and 100, inclusive. However, of course, the genome sequence represented by <i>s</i> may be much, much, and much longer than 100. You may also assume that each natural number in <i>s</i> representing the number of repetitions is at most 1,000.</p><p>The integer <i>i</i> is at least zero and at most one million.</p><p>A line containing two zeros separated by a space follows the last input line and indicates the end of the input.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each input line, your program should print a line containing the <i>i</i>-th letter in the genome sequence that <i>s</i> represents. If the genome sequence is too short to have the <i>i</i>-th element, it should just print a zero. No other characters should be printed in the output lines. Note that in this problem the index number begins from zero rather than one and therefore the initial letter of a sequence is its zeroth element.</p></div><p class="pst">Sample Input</p><pre class="sio">ABC 3
ABC 0
2(4(AB)3(XY))10C 30
1000(1000(1000(1000(1000(1000(NM)))))) 999999
0 0</pre><p class="pst">Sample Output</p><pre class="sio">0
A
C
M</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Japan+2006+Domestic">Japan 2006 Domestic</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3010">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3010">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3010">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
