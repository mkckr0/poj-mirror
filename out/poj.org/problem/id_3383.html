<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3383 -- Equation</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3383"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3383&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Equation</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td colspan="3"><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 103</td><td width="10px"></td><td><b>Accepted:</b> 15</td><td width="10px"></td><td style="font-weight:bold; color:red;">Special Judge</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>A few years ago Nick learned set theory, and liked it so much that sets became the subject of his bachelor’s thesis. Nick’s thesis describes a new kind of mathematical equations — set equations. Set equations are composed of set variables, which represent various subsets of a universal set Ω. The following four operations are defined for set variables:</p><ul><li><p>Intersection ∩: <i>A</i> ∩ <i>B</i> := {<i>x</i> : <i>x</i> ∈ <i>A</i> ∧ <i>x</i> ∈ <i>B</i>}</p></li><li><p>Union ∪: <i>A</i> ∪ <i>B</i> := {<i>x</i> : <i>x</i> ∈ <i>A</i> ∨ <i>x</i> ∈ <i>B</i>}</p></li><li><p>Difference −: <i>A</i> − <i>B</i> := {<i>x</i> : <i>x</i> ∈ <i>A</i> ∧ <i>x</i> ∉ <i>B</i>}</p></li><li><p>Symmetric difference ⊕: <i>A</i> ⊕ <i>B</i> := (<i>A</i> − <i>B</i>) ∪ (<i>B</i> − <i>A</i>)</p></li></ul><p>The operations are listed in the order of their precedence, i.e. intersection has the highest precedence, union has lower precedence than intersection, difference has lower precedence than union, and symmetrical difference has the lowest precedence. Parentheses can be used to change operations precedence as usual.</p><p>The thesis includes a chapter dedicated to automated solving of some specific classes of set equations. Nick has already elaborated a notation for storing equations in text files. Here is some quotation from the thesis:</p><blockquote><p>The following notation is used for describing set equations:</p><table align="center" border="0"><tr><td align="right">‹space or tab›</td><td align="center" style="width: 2em">→</td><td><i>space</i> | <i>tabulation symbo</i>l</td></tr><tr><td align="right">‹ws›</td><td align="center" style="width: 2em">→</td><td>‹space or tab› ∗</td></tr><tr><td align="right">‹char›</td><td align="center" style="width: 2em">→</td><td>‘<tt>A</tt>’ | ‘<tt>B</tt>’ | … | ‘<tt>Z</tt>’ | ‘<tt>a</tt>’ | ‘<tt>b</tt>’ | … | ‘<tt>z</tt>’</td></tr><tr><td align="right">‹var›</td><td align="center" style="width: 2em">→</td><td>‹char› ‹char› ∗</td></tr><tr><td align="right">‹expr›</td><td align="center" style="width: 2em">→</td><td>‹var›</td></tr><tr><td align="right"></td><td align="center" style="width: 2em">|</td><td>‹expr› ‹ws› ‹operator› ‹ws› ‹expr›</td></tr><tr><td align="right"></td><td align="center" style="width: 2em">|</td><td>‘<tt>(</tt>’ ‹ws› ‹expr› ‹ws› ‘<tt>)</tt>’</td></tr><tr><td align="right">‹operator›</td><td align="center" style="width: 2em">→</td><td>‘<tt>+</tt>’ | ‘<tt>-</tt>’ | ‘<tt>*</tt>’ | ‘<tt>^</tt>’</td></tr><tr><td align="right">‹equation›</td><td align="center" style="width: 2em">→</td><td>‹expr› ‹ws› ‘<tt>=</tt>’ ‹ws› ‹expr›</td></tr></table><p>Operators ∪, ∩, − and ⊕ are encoded with tokens ‘<tt>+</tt>’, ‘<tt>*</tt>’, ‘<tt>-</tt>’ and ‘<tt>^</tt>’ respectively. The ‘<tt>=</tt>’ token denotes the operator of set equality.</p><p>It is possible to assign values to some variable using the following notation:</p><table align="center" border="0"><tr><td align="right">‹digit›</td><td align="center" style="width: 2em">→</td><td>‘<tt>0</tt>’ | ‘<tt>1</tt>’ | … | ‘<tt>9</tt>’</td></tr><tr><td align="right">‹element›</td><td align="center" style="width: 2em">→</td><td>‹digit› ∗</td></tr><tr><td align="right">‹variable value›</td><td align="center" style="width: 2em">→</td><td>‹var› ‹ws› ‘<tt>=</tt>’ ‹ws› ‹values›</td></tr><tr><td align="right">‹values›</td><td align="center" style="width: 2em">→</td><td>‹element›</td></tr><tr><td> </td><td align="center" style="width: 2em">|</td><td>‹element› ‹space or tab› ‹ws› ‹values›</td></tr></table></blockquote><p>Unfortunately Nick is not very skilled in programming so he asks you to help and write a program module for automated solving of one specific simple class of equations — the equations where each variable, except Ω, occurs exactly one time.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>Input file is written in Nick’s notation.</p><p>The first line of the input file contains an equation to solve. Total length of the equation does not exceed <nobr>1 000</nobr> characters. There is exactly one occurrence of each variable, except “<tt>Omega</tt>”, in the equation.</p><p>The following lines contain definitions of variable values. Variable name lengths do not exceed ten characters each. There is always a variable called “<tt>Omega</tt>” that represents the universal set. Both the number of elements in the universal set and the value of each element does not exceed 500.</p><p>The total length of all variable definitions does not exceed <nobr>100 000</nobr> characters.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>First line of the output file must contain “<tt>Solution</tt>” if there exists at least one solution of the given equation and “<tt>No Solution</tt>” otherwise.</p><p>If the solution exists the following lines must contain such values of all undefined variables so that equation is satisfied. The variables may be listed in arbitrary order.</p></div><p class="pst">Sample Input</p><pre class="sio"></pre><table border="1" bordercolor="#000000" id="table1" style="border-collapse: collapse"><tr><th>#1</th><td>Omega - OneOrThree = Two<br/>Omega = 1 2 3<br/>Two = 2</td></tr><tr><th>#2</th><td>Omega * result * result = Empty<br/>Omega = 1 2 3 4 5<br/>Empty =</td></tr><tr><th>#3</th><td>(one+two) ^(TWO+three) = result<br/>one  =1<br/>TWO  =1 3 4 5<br/>two  =2<br/>three=3<br/>Omega=1 2 3 4 5<br/>result = 2 3 4 5</td></tr><tr><th>#4</th><td>Omega ^Omega = Omega<br/>Omega=123 234 345 456</td></tr></table><p class="pst">Sample Output</p><pre class="sio"></pre><table border="1" bordercolor="#000000" id="table1" style="border-collapse: collapse"><tr><th>#1</th><td>Solution<br/>OneOrThree = 1 3</td></tr><tr><th>#2</th><td>Solution<br/>Result=</td></tr><tr><th>#3</th><td>Solution</td></tr><tr><th>#4</th><td>No Solution</td></tr></table><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Northeastern+Europe+2006">Northeastern Europe 2006</a>, Northern Subregion</div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3383">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3383">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3383">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
