<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>1682 -- Clans on the Three Gorges</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D1682"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=1682&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Clans on the Three Gorges</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 10000K</td></tr><tr><td><b>Total Submissions:</b> 981</td><td width="10px"></td><td><b>Accepted:</b> 459</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">On the banks of the Three Gorges of the Yangtze River live some old clans. For historical reasons, clans on the same gorge hate each other, and conflicts often arise between them for lands and recourses. On the contrary they have a long and deep friendship with the clans on the other gorges. But it's difficult for them to travel to the other sides of the gorge because of the torrent flow of the Yangtze River.<br/> <br/>One day they decide to build suspension bridges between the gorges. The gorges have three banks (figure 1), and each bank is rolling so clans have different altitude. Every clan will not share a same bridge with other clans on the same bank, so there must be at least one bridge for each clan. And for safety reason, bridges are not allowed to cross each other overhead, or if a bridge collapsed, it would fall on another one. Experts point out that if the altitudes of the two ends of a bridge are different, the bridge will be troublesome to build and cost more. It's estimated that the cost of a bridge is equal to the fall of the ends of the bridge. The clans are not rich, so they employ you to find a solution to minimize the cost to build the suspension bridges to satisfy their demand.<br/><center><img src="../images/1682_1.jpg"/></center> <br/>As show in figure 1, the three gorges are named X, Y and Z respectively. A clan is represented by a cycle, with its name and altitude in. Clans on gorge X are named x1, x2... xn in counter-clockwise order. Those on gorge Y and gorge Z are y1, y2... ym and z1, z2? zk in counter-clockwise order too. A bridge is represented by a line between two clans with its cost on it. No two lines can intersect and no clan has zero degree according to the description of this problem.<br/> <br/>For example, figure 2 is invalid solution because the two bridges intersect. Figure 3 is also invalid for the reason that clan y1 doesn't has a bridge for its own. Figure 1 and Figure 4 both are valid solutions for there are no intersected bridges or isolated clan in these solutions. The cost of a solution is the sum of all the costs of the bridges in the solution. And the cost of a bridge is equal to the absolute value of the difference of the heights of the two ends. So figure 1 has cost 11 against 14 of figure 4. It's clear that figure 1 is a better solution. In fact, it's one of the best solutions. You are required to write a program to find the minimum cost.<br/><center><img src="../images/1682_2.jpg"/></center> <br/><center><img src="../images/1682_3.jpg"/></center></div><p class="pst">Input</p><div class="ptx" lang="en-US">The input consists of T test cases. The first line contains the number T (1 &lt;= T &lt;= 10). Then follow the T test cases. Each test case is started with a line contains three integers n, m and k (1 &lt;= n, m, k &lt;= 100), representing the number of clans on gorges X, gorge Y and gorge Z. The next three lines will contain the height of clans on the three gorges, the heights are positive integer less than 100. Test cases are separated by a blank line. The clans are named as described in the comment of figure 1. Their names also refer to their altitude. So the input of a case is of the form:<br/> <br/>n m k<br/>x1 x2 x3 ... xn<br/>y1 y2 y3 ... ym<br/>z1 z2 z3 ... zk<br/></div><p class="pst">Output</p><div class="ptx" lang="en-US">The output contains T integers. Each line contains the minimum cost to the corresponding case of the input.</div><p class="pst">Sample Input</p><pre class="sio">2
3 3 3
4 4 3
6 1 2
3 6 1

1 1 2
1
5
2 3
</pre><p class="pst">Sample Output</p><pre class="sio">11
5
</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=POJ+Monthly--2004.06.27+epic">POJ Monthly--2004.06.27 epic</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=1682">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=1682">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=1682">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
