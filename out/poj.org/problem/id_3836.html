<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3836 -- P2P File Sharing System</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3836"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3836&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">P2P File Sharing System</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 272</td><td width="10px"></td><td><b>Accepted:</b> 112</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">Peer-to-peer(P2P) computing technology has been widely used on the Internet to exchange data. A lot of P2P file sharing systems exist and gain much popularity in nowadays.<br/> <br/>Let's consider a simplified model of P2P file sharing system: There are many computers in the system, and they can receive data from or send data to others. To simplify the problem, let's assume that there is just ONE large file which is of our concern in the system. Some computers already have the whole file (we call them "servers") and some don't(we call them "clients"). Every client needs to download the file from servers. When a client gets the WHOLE file, it becomes a server.<br/> <br/>These computers are not always online. An online client will down load the file from all online servers. Different servers send data of different parts of the file to a client, so the client can download the file faster.<br/> <br/>Now given the transfer speed between each pair of computers, what time is every computer online or offline, and which computers are servers at the beginning, please analyze the running of the system in a period of time.</div><p class="pst">Input</p><div class="ptx" lang="en-US">The first line contains an integer indicating the number of test cases.<br/> <br/> <br/>For each test case:<br/> <br/>Line 1: It contains two positive integers: n and T (n &lt;= 20, T &lt;= 1000) meaning that there are n computers in the system numbered from 1 to n, and you task is to figure out that how many percentage of the file does every computer gets after T seconds from the beginning.<br/> <br/>Line 2: It contains two positive integers: k and S (k &lt;= n, S &lt;= 2<sup>20</sup>) meaning that at the beginning there are k servers, and the size of the file of our concern is S (KB).<br/> <br/>Line 3: It contains k integers. It's a list of all servers' No.<br/> <br/>Line 4 ~ n+3: These n lines form a matrix of size n x n. The j-th integer in the i-th row of the matrix represents the transfer speed (in KB/s, no more than 2<sup>10</sup>) between computer i and computer j (i and j start from 1). The matrix is symmetrical and the integers on the diagonal are meaningless.<br/> <br/>Line n+4 ~ 2n+3: Each line contains an online/offline pattern for a computer in the following format (These lines are in the ascending order of computer No.):<br/> <br/><center>t online_time<sub>1</sub> offline_time<sub>1</sub> online_time<sub>2</sub> offline_time<sub>2</sub>...online_time<sub>t</sub> offline_time<sub>t</sub></center> <br/> <br/>t is an integer no more than 10 and the time given are all non-negative integers and in ascending order. During the time between online_time<sub>i</sub> and offline_time<sub>i</sub>, the computer is online and can download data from other computers or send data to other computers.<br/> <br/>Line 2n+4: It contains one positive integer m, representing the number of download actions in the system.<br/> <br/>Line 2n+5 ~ 2n+m+4: Each line contains two integers representing a download action in the following format:<br/> <br/><center>download_time<sub>i</sub> computer_id<sub>i</sub></center> <br/> <br/>At time download_time<sub>i</sub>, the computer_id<sub>i</sub> computer starts to download the file, where 0 &lt;= download_time<sub>i</sub> &lt;= T, 1 &lt;= computer_id<sub>i</sub> &lt;= n.<br/> <br/>These lines are given in non-descending order of time. It's guaranteed that servers never try to download the file. It's ensured that at time download_time<sub>i</sub> the computer computer_id<sub>i</sub> is online (Though it's possible that it instantly go offline after issuing a download command).<br/> <br/>When a client starts to download, it will try to connect to all servers and download data simultaneously from online servers. The client's download speed is the sum of all connections. We assume the construction of a connection to be instant and cost no time. Only data transfer is time consuming.<br/> <br/>When a client goes offline, unfinished download task will be saved and continued when it's online next time. If a server goes online, all computers that are currently downloading will connect to it and download data from it. What's more, when a client becomes a server, it begins to send data to clients immediately.<br/> <br/> <br/>NOTE: To simplify the problem, time used to download a file should be rounded up to integer (If the file size is 6KB and download speed is 5KB/s, the download task will cost 2 seconds instead of 1.2 seconds -- 5KB for the first second and 1KB for the next second).<br/> <br/>Please note that all times given above are in seconds.</div><p class="pst">Output</p><div class="ptx" lang="en-US">For each test case, the output should contain n lines, each for a computer.<br/> <br/>The i-th line contains a percentage indicating the amount of data the i-th computer gets after T seconds from the beginning, in the format: 'percentage%'. The percentage should be rounded down to integer.</div><p class="pst">Sample Input</p><pre class="sio">Sample input #1:

1
2 50
1 1024
1
0 10
10 0
1 0 50
1 10 40
1
10 2


Sample input #2

1
4 500
2 200
2 3
0 1 1 1
1 0 1 1
1 1 0 1
1 1 1 0
2 0 200 300 500
1 100 200
1 200 400
1 301 500
2
0 1
301 4</pre><p class="pst">Sample Output</p><pre class="sio">Sample output #1:

100%
29%


Sample output #2:

100%
100%
100%
99%</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">There are 2 computers. The file size is 1024 KB and Computer 1 is a server at the beginning. At time 10, computer 2 start to download that file from computer 1 until it goes offline at time 40. Totally 10KB/s x 30s = 300KB is downloaded. 300/1024 <img align="absmiddle" alt="\approx" src="../formula?tex=%5Capprox"/> 29%.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Ningbo+2009">Ningbo 2009</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3836">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3836">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3836">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
