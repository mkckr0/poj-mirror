<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3334 -- Connected Gheeves</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3334"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3334&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Connected Gheeves</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 1173</td><td width="10px"></td><td><b>Accepted:</b> 406</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><div><p>Gheeves (plural of gheef) are some objects similar to funnels. We define a gheef as a two dimensional object specified by a sequence of points (<i>p</i><sub>1</sub>, <i>p</i><sub>2</sub>, ..., <i>p<sub>n</sub></i>) with the following conditions:</p><ul><li>3 ≤ <i>n</i> ≤ 1000</li><li>If a point <i>p<sub>i</sub></i> is specified by the coordinates (<i>x<sub>i</sub></i>, <i>y<sub>i</sub></i>), there is an index 1 &lt; <i>c</i> &lt; <i>n</i> such that <i>y<sub>1</sub></i> &gt; <i>y<sub>2</sub></i> &gt; ... &gt; <i>y<sub>c</sub></i> and <i>yc</i> &lt; <i>y</i><sub><i>c</i>+1</sub> &lt; <i>y</i><sub><i>c</i>+2</sub> &lt; ... &lt; <i>y<sub>n</sub></i>. <i>p<sub>c</sub></i> is called the cusp of the gheef.</li><li>For all 1 ≤ <i>i</i> &lt; <i>c</i>, <i>x<sub>i</sub></i> &lt; <i>x<sub>c</sub></i> and for all <i>c</i> &lt; <i>i</i> ≤ <i>n</i>, <i>x<sub>i</sub></i> &gt; <i>x<sub>c</sub></i>.</li><li>For 1 &lt; <i>i</i> &lt; <i>c</i>, the amount of rotation required to rotate <i>p<sub>i-1</sub></i> around <i>p<sub>i</sub></i> in clockwise direction to become co-linear with <i>p<sub>i</sub></i> and <i>p<sub>i+1</sub></i>, is greater than 180 degrees. Likewise, for <i>c</i> &lt; <i>i</i> &lt; <i>n</i>, the amount of rotation required to rotate <i>p<sub>i-1</sub></i> around <i>p<sub>i</sub></i> in clockwise rotation to become co-linear with <i>p<sub>i</sub></i> and <i>p<sub>i+1</sub></i>, is greater than 180 degrees.</li><li>The set of segments joining two consecutive points of the sequence intersect only in their endpoints.</li></ul><p>For example, the following figure shows a gheef of six points with <i>c</i> = 4:</p><p></p><center><img src="../images/3334_1.GIF"/></center><p>We call the sequence of segments (<i>p</i><sub>1</sub><i>p</i><sub>2</sub>, <i>p</i><sub>2</sub><i>p</i><sub>3</sub>, ..., <i>p</i><sub>n-1</sub><i>p</i><sub>n</sub>), the body of the gheef. In this problem, we are given two gheeves <i>P</i> = (<i>p</i><sub>1</sub>, <i>p</i><sub>2</sub>, ..., <i>p<sub>n</sub></i>) and <i>Q</i> = (<i>q</i><sub>1</sub>, <i>q</i><sub>2</sub>, ..., <i>q<sub>m</sub></i>), such that all <i>x</i> coordinates of <i>p<sub>i</sub></i> are negative integers and all x coordinates of qi are positive integers. Assuming the cusps of the two gheeves are connected with a narrow pipe, we pour a certain amount of water inside the gheeves. As we pour water, the gheeves are filled upwards according to known physical laws (the level of water in two gheeves remains the same). Note that in the gheef <i>P</i>, if the level of water reaches min(<i>y</i><sub>1</sub>, <i>y<sub>n</sub></i>), the water pours out of the gheef (the same is true for the gheef <i>Q</i>). Your program must determine the level of water in the two gheeves after pouring a certain amount of water. Since we have defined our problem in two dimensions, the amount of water is measured in terms of area it fills. Note that the volume of pipe connecting cusps is considered as zero.</p></div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first number in the input line, <i>t</i> is the number of test cases. Each test case is specified on three lines of input. The first line contains a single integer a (1 ≤ a ≤ 100000) which specifies the amount of water poured into two gheeves. The next two lines specify the two gheeves <i>P</i> and <i>Q</i> respectively, each of the form <i>k</i> <i>x</i><sub>1</sub> <i>y</i><sub>1</sub> <i>x</i><sub>2</sub> <i>y</i><sub>2</sub> ... <i>x<sub>k</sub></i> <i>y<sub>k</sub></i> where <i>k</i> is the number of points in the gheef (<i>n</i> for <i>P</i> and <i>m</i> for <i>Q</i>), and the <i>x<sub>i</sub></i> <i>y<sub>i</sub></i> sequence specify the coordinates of the points in the sequences.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>The output contains <i>t</i> lines, each corresponding to an input test case in that order. The output line contains a single integer <i>L</i> indicating the final level of water, expressed in terms of <i>y</i> coordinates rounded to three digits after decimal points.<br/>　</p></div><p class="pst">Sample Input</p><pre class="sio">2
25
3 -30 10 -20 0 -10 10
3 10 10 20 0 30 10
25
3 -30 -10 -20 -20 -10 -10
3 10 10 20 0 30 10
</pre><p class="pst">Sample Output</p><pre class="sio">3.536
-15.000
</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Tehran+2006+Preliminary">Tehran 2006 Preliminary</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3334">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3334">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3334">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
