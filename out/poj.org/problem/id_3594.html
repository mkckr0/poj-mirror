<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3594 -- Escort of Dr. Who How</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3594"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3594&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Escort of Dr. Who How</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 2000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 131072K</td></tr><tr><td><b>Total Submissions:</b> 2907</td><td width="10px"></td><td><b>Accepted:</b> 789</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>The notorious ringleader and cyber-criminal Derek Wu, better known as Dr. Who How, has been convicted for multiple abductions and cyber-frauds several minutes ago. He will soon be transferred from the court to the prison to serve a life sentence. Intelligence from undercover officers in Dr. Who How’s outlawed gang indicates a possible forcible rescue operation by gang members in the case that Dr. Who How is convicted. To ensure a successful escort, besides adopting enhanced security measures, the police force further desires to minimize the escort time—the time that the motorcade of escort has to spend between departure from the court and arrival at the prison.</p><p>The complex traffic condition in the city imposes complications on the police force’s escort effort. While the municipal government has agreed to temporarily shut down a few roads for exclusive police use, the shut-down time windows vary among roads and are generally narrow to avoid excessively disturbing the life of the citizens. The motorcade of escort must pass through any road entirely within its shut-down time window and not use any road that the municipal government has not agreed to shut down.</p><p>Given information about all roads available to the police force for the escort, determine the shortest escort time.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains a single test case. The first line contains four integers <i>n</i>, <i>m</i>, <i>s</i> and <i>t</i> (2 ≤ <i>n</i> ≤ 100; 0 ≤ <i>m</i> ≤ 1000; 1 ≤ <i>s</i>, <i>t</i> ≤ <i>n</i>; <i>s</i> ≠ <i>t</i>). There are <i>n</i> junctions, some pairs of which are connected by <i>m</i> roads. The court and the prison are located at the <i>s</i>-th and the <i>t</i>-th junctions, respectively. The next <i>m</i> lines each contain five integers <i>x</i>, <i>y</i>, <i>b</i>, <i>e</i> and <i>c</i> (1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>; 0 ≤ <i>b</i> &lt; <i>e</i> ≤ 10<sup>4</sup>; 1 ≤ <i>c</i> ≤ 10<sup>4</sup>), indicating that the directed lanes running from the <i>x</i>-th junction to the <i>y</i>-th junction of a road that takes the motorcade of escort <i>c</i> units of time to pass through will be shut down between time <i>b</i> and <i>e</i>. The earliest time when the motorcade can leave the court is time 0.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>If the escort is possible, print the shortest escort time; otherwise, print “<tt>Impossible</tt>”.</p></div><p class="pst">Sample Input</p><pre class="sio">4 5 1 4
1 2 0 1 1
1 2 0 1 2
1 3 1 3 2
2 4 3 4 1
3 4 3 4 1</pre><p class="pst">Sample Output</p><pre class="sio">3</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>The sample is depicted in Figure 1. Each junction is represented by a numbered spot. Each road is represented by an arrow labeled with <img align="absmiddle" alt="\langle\langle b,e\rangle,c\rangle" src="../formula?tex=%5Clangle%5Clangle+b%2Ce%5Crangle%2Cc%5Crangle"/>, its shut-down time window and pass-through time.</p><p align="center"><img src="../images/3594_1.png"/></p><p align="center">Figure 1: Depiction of the sample</p><p>The second road listed in the sample is virtually unusable for it takes the motorcade of escort longer time to pass through than it can stay available. The remaining four roads enable the following two escort routes:</p><ol><li><img align="absmiddle" alt="1\stackrel{\!\langle 0,1\rangle}{\to}2\stackrel{\!\langle 3,4\rangle}{\to}4" src="../formula?tex=1%5Cstackrel%7B%5C%21%5Clangle+0%2C1%5Crangle%7D%7B%5Cto%7D2%5Cstackrel%7B%5C%21%5Clangle+3%2C4%5Crangle%7D%7B%5Cto%7D4"/></li><li><img align="absmiddle" alt="1\stackrel{\!\langle 1,3\rangle}{\to}3\stackrel{\!\langle 3,4\rangle}{\to}4" src="../formula?tex=1%5Cstackrel%7B%5C%21%5Clangle+1%2C3%5Crangle%7D%7B%5Cto%7D3%5Cstackrel%7B%5C%21%5Clangle+3%2C4%5Crangle%7D%7B%5Cto%7D4"/></li></ol><p>(The label <img align="absmiddle" alt="\langle s,t\rangle" src="../formula?tex=%5Clangle+s%2Ct%5Crangle"/> over an arrow indicates that the motorcade passes through the corresponding road between time <i>s</i> and <i>t</i>.) The first route takes four units of escort time, whereas the second takes three, which is the shortest possible.</p></div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=PKU+Campus+2008+%28POJ+Founder+Monthly+Contest+%E2%80%93+2008.05.10%29">PKU Campus 2008 (POJ Founder Monthly Contest – 2008.05.10)</a>, frkstyc</div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3594">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3594">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3594">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
