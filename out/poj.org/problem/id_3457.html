<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3457 -- Mineshaft</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3457"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3457&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Mineshaft</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 3000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 105</td><td width="10px"></td><td><b>Accepted:</b> 11</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><p>A plumber has been hired to build an air pipe through a mineshaft from the bottom to the surface. The mineshaft was built without modern technology, so it winds its way up through the earth. Because it is very time consuming to bring the tools necessary to bend the pipe below the surface, the plumber wants to minimize the number of bends in the pipeline.</p><p>For example, for the mineshaft in the first picture below, the minimal number of bends in a pipeline from the bottom to the surface is two. Different optimal solutions exist, one of which is shown in the second picture. The bullets indicate the bends in the pipeline.</p><div align="center"><img src="../images/3457_1.png"/></div><p>The two walls of the mineshaft are formed by sequences of straight segments. The numbers of segments in the two sequences may be different. Further, the horizontal distance between the walls of the mineshaft may vary, but is always positive. Both walls start at the same level and end at the same level.</p><p>On the way from the bottom of the mineshaft to the surface, the level (the <i>y</i>-coordinate) increases with every segment of a wall. Hence, the mineshaft does not have horizontal plateaus or ‘ceilings’, and at no point does it go back down again.</p><p>For the purpose of this task, you may assume the diameter of the pipeline to be 0. At no point may the pipeline cross the walls. In order to attach the pipeline firmly to the wall, each segment of the pipeline has to touch the walls at (at least) two different places. However, the bending points of the pipeline are weak. They cannot be used to attach the pipeline to the walls. The end points of the pipeline, though, at the bottom and the top of the mineshaft, may be used to attach a segment to the walls.</p><p>Hence, the solution in the third picture above (also having two bends) is not allowed, because the lowest segment of the pipeline can be attached to the walls at only one place: at the bottom of the right wall.</p><p>The pipeline must start anywhere at the bottom of the mineshaft, and must end anywhere on the imaginary line between the top of the left wall and the top of the right wall. Note, however, that the endpoints of the pipeline may only be used to attach the pipeline, if they touch a wall. In particular, the endpoint at the bottom cannot be attached to any position at the bottom which is not the bottom of a wall.</p><p>Finally, the angle that the pipeline makes at a bending point can take any value satisfying −180° &lt; <i>α</i> &lt; 180° and (of course) <i>α</i> ≠ 0.</p><p>Note that sometimes it may be useful to have the pipeline intersect with itself. For example, in the mineshaft below, this is needed to get from the bottom to the top of the mineshaft with only three bends.</p><div align="center"><img src="../images/3457_2.png"/></div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains a single number: the number of test cases to follow. Each test case has the following format:</p><ul><li><p>One line with one integer <i>N</i><sub>1</sub> (2 ≤ <i>N</i><sub>1</sub> ≤ 25): the number of points describing the left wall of the mineshaft.</p></li><li><p><i>N</i><sub>1</sub> lines with the coordinates of the points describing the left wall of the mineshaft, from the bottom to the top. The <i>i</i><sup>th</sup> line contains two integers <i>x<sub>i</sub></i> and <i>y<sub>i</sub></i> (−1,000 ≤ <i>x<sub>i</sub></i> ≤ 1,000 and 0 ≤ <i>y<sub>i</sub></i> ≤ 1,000) separated by a single space: the <i>x</i>- and <i>y</i>-coordinate of the point, respectively.</p><p>The <i>y</i>-coordinates are monotonically increasing: <i>y</i><sub>1</sub> &lt; <i>y</i><sub>2</sub> &lt; … &lt; <i>y</i><sub><i>N</i><sub>1</sub></sub>.</p></li><li><p>One line with one integer <i>N</i><sub>2</sub> (2 ≤ <i>N</i><sub>2</sub> ≤ 25): the number of points describing the right wall of the mineshaft.</p></li><li><p><i>N</i><sub>2</sub> lines with the coordinates of the points describing the right wall of the mineshaft, from the bottom to the top. The <i>i</i><sup>th</sup> line contains two integers <i>x′<sub>i</sub></i> and <i>y′<sub>i</sub></i> (−1,000 ≤ <i>x′<sub>i</sub></i> ≤ 1,000 and 0 ≤ <i>y′<sub>i</sub></i> ≤ 1,000) separated by a single space: the <i>x</i>- and <i>y</i>-coordinate of the point, respectively.</p><p>The y-coordinates are monotonically increasing: <i>y′</i><sub>1</sub> &lt; <i>y′</i><sub>2</sub> &lt; … &lt; <i>y′</i><sub><i>N</i><sub>2</sub></sub>.</p></li></ul><p>We always have <i>x</i><sub>1</sub> &lt; <i>x′</i><sub>1</sub>, <i>y</i><sub>1</sub> = <i>y′</i><sub>1</sub>, <i>x<sub>N</sub></i><sub>1</sub> &lt; <i>x′</i><sub><i>N</i><sub>2</sub></sub>, and <i>y<sub>N</sub></i><sub><sub>1</sub></sub> = <i>y′</i><sub><i>N</i><sub>2</sub></sub>. The walls described by the sequences of points do not cross or even touch each other.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For every test case in the input file, the output should contain a single number, on a single line: the minimum number of bends in the pipeline to make it from the bottom of the mineshaft to the top, under the conditions from the problem description.</p></div><p class="pst">Sample Input</p><pre class="sio">2
7
4 0
8 2
3 7
5 9
3 12
6 14
4 16
5
7 0
10 2
6 6
10 12
8 16
6
-10 10
-10 20
10 22
5 27
0 37
5 47
8
-8 10
-8 16
3 17
9 19
14 24
18 32
18 40
11 47</pre><p class="pst">Sample Output</p><pre class="sio">2
3</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">These testcases correspond to the pictures in the problem description.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=BAPC+2006+Qualification">BAPC 2006 Qualification</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3457">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3457">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3457">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
