<html><head><meta content="no-cache" http-equiv="Pragma"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="en-US" http-equiv="Content-Language"/><title>3195 -- Generalized Matrioshkas</title><link href="../poj.css" rel="stylesheet" type="text/css"/><link href="../poj.ico" rel="shortcut icon"/><link href="../poj.gif" rel="icon" type="image/gif"/><script language="javascript" src="../poj.js"></script></head><body alink="blue" lang="en-US" leftmargin="5" link="blue" onkeydown="KeyDown(event)" vlink="blue"><a name="top"></a><table border="1" bordercolor="#ffffff" style="BORDER-COLLAPSE: collapse" width="100%"><tbody><tr><td align="CENTER" colspan="5"><table cellpadding="0" class="h1"><tr><td align="left" width="25%"><img border="0" height="100" src="../images/logo1.jpg"/></td><td bgcolor="#EAEFFD" colspan="3"><table class="h2"><tr><td><img border="0" height="90" src="../images/logo0.gif" width="450"/></td><td width="95"><img border="0" height="95" src="../images/logo3.gif" width="95"/></td></tr></table></td></tr></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><a href="http://poj.org/bbs">Web Board</a><br/><a href="../index.html">Home Page</a><br/><a href="../page/id_1000.html" target="_blank">F.A.Qs</a><br/><a href="http://poj.org/chart">Statistical Charts</a></td><td class="h" onmouseout="scbg(this, 0)" onmouseover="scbg(this, 1)"><form onsubmit="event.preventDefault(); let pid = (new FormData(event.target)).get('pid'); window.location=`../problem/id_${pid}.html`"><a href="../problemlist.html">Problems</a><br/><a href="http://poj.org/submit">Submit Problem</a><br/><a href="http://poj.org/status">Online Status</a><br/><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"/><input name="pb1" type="Submit" value="Go"/></form></td><td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="searchuser" method="GET"><a href="http://poj.org/register">Register</a><br/><a href="http://poj.org/modifyuser">Update your info</a><br/><a href="http://poj.org/userlist">Authors ranklist</a><br/><input name="key" size="10" type="text"/><input name="B1" type="Submit" value="Search"/></form></td>
<td class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><font color="#1a5cc8">Current Contest</font><br/><a href="http://poj.org/pastcontests">Past Contests</a><br/><a href="http://poj.org/contests">Scheduled Contests</a><br/><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td align="left" class="h" onmouseout="scbg(this,0)" onmouseover="scbg(this,1)"><form action="login" method="POST"><table><tr><td>User ID:</td><td><input name="user_id1" size="10" style="font-family:monospace" type="text"/></td></tr><tr><td>Password:</td><td><input name="password1" size="10" style="font-family:monospace" type="password"/></td></tr></table><input name="B1" type="Submit" value="login"/>  <a href="http://poj.org/register" target="_parent">Register</a><input name="url" type="hidden" value="%2Fproblem%3Fid%3D3195"/></form></td></tr></tbody></table><table background="../images/table_back.jpg" border="0" width="100%"><tr><td>
<div style="position: absolute; right: 10px;">Language:<select onchange="window.location.href='problem?id=3195&amp;lang='+this.value+'&amp;change=true'" size="1"><option selected="" value="default">Default</option></select></div><div class="ptt" lang="en-US">Generalized Matrioshkas</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 2276</td><td width="10px"></td><td><b>Accepted:</b> 678</td></tr></table></div><p class="pst">Description</p><div class="ptx" lang="en-US"><span lang="en-us"><p>Vladimir worked for years making matrioshkas, those nesting dolls that certainly represent truly Russian craft. A matrioshka is a doll that may be opened in two halves, so that one finds another doll inside. Then this doll may be opened to find another one inside it. This can be repeated several times, till a final doll – that cannot be opened – is reached.</p><p>Recently, Vladimir realized that the idea of nesting dolls might be generalized to nesting toys. Indeed, he has designed toys that contain toys but in a more general sense. One of these toys may be opened in two halves and it may have more than one toy inside it. That is the new feature that Vladimir wants to introduce in his new line of toys.</p><p>Vladimir has developed a notation to describe how nesting toys should be constructed. A toy is represented with a positive integer, according to its size. More precisely: if when opening the toy represented by <i> m</i> we find the toys represented by <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, …, <i>n<sub>r</sub></i>, it must be true that <i>n</i><sub>1</sub> + <i>n</i><sub>2</sub> + … + <i>n<sub>r</sub></i> &lt; <i>m</i>. And if this is the case, we say that toy m contains directly the toys <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, …, <i>n<sub>r</sub></i>. It should be clear that toys that may be contained in any of the toys <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, …, <i>n<sub>r</sub></i> are not considered as directly contained in the toy <i>m</i>.</p><p>A <i>generalized matrioshka</i> is denoted with a non-empty sequence of non zero integers of the form:</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32"><i>a</i><sub>1</sub></td><td align="center" width="32"><i>a</i><sub>2</sub></td><td align="center" width="32"><span lang="en-us">…</span></td><td align="center" width="32"><i>a<sub>N</sub></i></td></tr></table></div><p>such that toy <i>k</i> is represented in the sequence with two integers −<i>k</i> and <i>k</i>, with the negative one occurring in the sequence first that the positive one.</p><p>For example, the sequence</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">−9</td><td align="center" width="32">−7</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">−3</td><td align="center" width="32">−2</td><td align="center" width="32">−1</td><td align="center" width="32">1</td><td align="center" width="32">2</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>represents a generalized matrioshka conformed by six toys, namely, 1, 2 (twice), 3, 7 and 9. Note that toy 7 contains directly toys 2 and 3. Note that the first copy of toy 2 occurs left from the second one and that the second copy contains directly a toy 1. It would be wrong to understand that the first −2 and the last 2 should be paired.</p><p>On the other hand, the following sequences do not describe generalized matrioshkas:</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">−9</td><td align="center" width="32">−7</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">−3</td><td align="center" width="32">−1</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">1</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>because toy 2 is bigger than toy 1 and cannot be allocated inside it.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">−9</td><td align="center" width="32">−7</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">−3</td><td align="center" width="32">−2</td><td align="center" width="32">−1</td><td align="center" width="32">1</td><td align="center" width="32">2</td><td align="center" width="32">3</td><td align="center" width="32">7</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">9</td></tr></table></div><p>because 7 and 2 may not be allocated together inside 9.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0"><tr><td align="center" width="32">−9</td><td align="center" width="32">−7</td><td align="center" width="32">−2</td><td align="center" width="32">2</td><td align="center" width="32">−3</td><td align="center" width="32">−1</td><td align="center" width="32">−2</td><td align="center" width="32">3</td><td align="center" width="32">2</td><td align="center" width="32">1</td><td align="center" width="32">7</td><td align="center" width="32">9</td></tr></table></div><p>because there is a nesting problem within toy 3.</p><p>Your problem is to write a program to help Vladimir telling good designs from bad ones.</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input file contains several test cases, each one of them in a separate line. Each test case is a sequence of non zero integers, each one with an absolute value less than 10<sup>7</sup>.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>Output texts for each input case are presented in the same order that input is read.</p><p>For each test case the answer must be a line of the form</p><p><code>:-) Matrioshka!</code></p><p>if the design describes a generalized matrioshka. In other case, the answer should be of the form</p><p><code>:-( Try again.</code></p></div><p class="pst">Sample Input</p><pre class="sio">-9 -7 -2 2 -3 -2 -1 1 2 3 7 9
-9 -7 -2 2 -3 -1 -2 2 1 3 7 9
-9 -7 -2 2 -3 -1 -2 3 2 1 7 9
-100 -50 -6 6 50 100
-100 -50 -6 6 45 100
-10 -5 -2 2 5 -4 -3 3 4 10
-9 -5 -2 2 5 -4 -3 3 4 9</pre><p class="pst">Sample Output</p><pre class="sio">:-) Matrioshka!
:-( Try again.
:-( Try again.
:-) Matrioshka!
:-( Try again.
:-) Matrioshka!
:-( Try again.</pre><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Colombia+2006">Colombia 2006</a></div></td></tr></table>
<font color="#333399" size="3"><p align="center">
[<a href="http://poj.org/submit?problem_id=3195">Submit</a>]  
 [<a href="javascript:history.go(-1)">Go Back</a>]   [<a href="http://poj.org/problemstatus?problem_id=3195">Status</a>]   
[<a href="http://poj.org/bbs?problem_id=3195">Discuss</a>]
</p></font>
<p><img border="0" height="30" src="../images/home.gif" width="40"/><font size="3"><a href="../index.html">Home Page</a> </font>  <img border="0" height="30" src="../images/goback.gif" width="40"/><font size="3"><a href="javascript:history.go(-1)">Go Back</a>  <img border="0" height="30" src="../images/top.gif" width="40"/><a href="http://poj.org#top">To top</a></font><br/></p><hr/><p align="center" style="font-family:Arial, Helvetica, sans-serif">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br/>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p></body></html>
